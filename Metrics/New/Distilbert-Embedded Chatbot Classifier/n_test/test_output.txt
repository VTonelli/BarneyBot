Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 13.38it/s]

Creating triplets...
100%|██████████| 15825/15825 [01:09<00:00, 228.96it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1484/1484 [00:07<00:00, 186.16it/s]

Checking triplets hardness...
100%|██████████| 63300/63300 [00:00<00:00, 173719.80it/s]

Filtering dataset...

##############################
Dataset length:       2
Hard negatives count: 63298
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 1/1 [00:00<00:00, 23.79it/s]
Iteration: 100%|██████████| 1/1 [00:00<00:00, 24.08it/s]
Epoch: 100%|██████████| 2/2 [00:00<00:00, 21.99it/s]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1484/1484 [00:07<00:00, 203.79it/s]

Checking triplets hardness...
100%|██████████| 63300/63300 [00:00<00:00, 174780.96it/s]

Filtering dataset...

##############################
Dataset length:       2
Hard negatives count: 63298
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 1/1 [00:00<00:00, 25.10it/s]
Iteration: 100%|██████████| 1/1 [00:00<00:00, 24.02it/s]
Epoch: 100%|██████████| 2/2 [00:00<00:00, 22.54it/s]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1484/1484 [00:07<00:00, 198.26it/s]

Checking triplets hardness...
100%|██████████| 63300/63300 [00:00<00:00, 179325.48it/s]

Filtering dataset...

##############################
Dataset length:       2
Hard negatives count: 63298
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 1/1 [00:00<00:00, 25.71it/s]
Iteration: 100%|██████████| 1/1 [00:00<00:00, 24.48it/s]
Epoch: 100%|██████████| 2/2 [00:00<00:00, 23.07it/s]

Training classifier
Batches: 100%|██████████| 495/495 [00:01<00:00, 286.46it/s]

Testing
Batches: 100%|██████████| 59/59 [00:00<00:00, 307.02it/s]


###############
# ETA:  9e+02 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 13.77it/s]

Creating triplets...
100%|██████████| 15745/15745 [01:09<00:00, 226.43it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1477/1477 [01:51<00:00, 13.30it/s]

Checking triplets hardness...
100%|██████████| 62980/62980 [00:00<00:00, 153807.66it/s]

Filtering dataset...

##############################
Dataset length:       33972
Hard negatives count: 29008
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 531/531 [07:28<00:00,  1.18it/s]
Iteration: 100%|██████████| 531/531 [07:26<00:00,  1.19it/s]
Epoch: 100%|██████████| 2/2 [14:54<00:00, 447.37s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1477/1477 [01:51<00:00, 13.25it/s]

Checking triplets hardness...
100%|██████████| 62980/62980 [00:00<00:00, 136776.42it/s]

Filtering dataset...

##############################
Dataset length:       32545
Hard negatives count: 13129
Easy positives count: 17306
############################## 

Training...
Iteration: 100%|██████████| 509/509 [07:04<00:00,  1.20it/s]
Iteration: 100%|██████████| 509/509 [07:03<00:00,  1.20it/s]
Epoch: 100%|██████████| 2/2 [14:07<00:00, 423.98s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1477/1477 [01:52<00:00, 13.16it/s]

Checking triplets hardness...
100%|██████████| 62980/62980 [00:00<00:00, 133966.90it/s]

Filtering dataset...

##############################
Dataset length:       32490
Hard negatives count: 13346
Easy positives count: 17144
############################## 

Training...
Iteration: 100%|██████████| 508/508 [07:03<00:00,  1.20it/s]
Iteration: 100%|██████████| 508/508 [06:56<00:00,  1.22it/s]
Epoch: 100%|██████████| 2/2 [14:00<00:00, 420.16s/it]

Training classifier
Batches: 100%|██████████| 493/493 [00:10<00:00, 47.54it/s] 

Testing
Batches: 100%|██████████| 56/56 [00:01<00:00, 50.08it/s]


###############
# ETA:  1e+04 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.44it/s]

Creating triplets...
100%|██████████| 15665/15665 [01:06<00:00, 235.02it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1469/1469 [03:22<00:00,  7.25it/s]

Checking triplets hardness...
100%|██████████| 62660/62660 [00:00<00:00, 149681.48it/s]

Filtering dataset...

##############################
Dataset length:       32894
Hard negatives count: 29766
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 514/514 [09:10<00:00,  1.07s/it]
Iteration: 100%|██████████| 514/514 [09:11<00:00,  1.07s/it]
Epoch: 100%|██████████| 2/2 [18:21<00:00, 550.89s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1469/1469 [03:24<00:00,  7.20it/s]

Checking triplets hardness...
100%|██████████| 62660/62660 [00:00<00:00, 131682.76it/s]

Filtering dataset...

##############################
Dataset length:       26862
Hard negatives count: 4224
Easy positives count: 31574
############################## 

Training...
Iteration: 100%|██████████| 420/420 [07:23<00:00,  1.06s/it]
Iteration: 100%|██████████| 420/420 [07:20<00:00,  1.05s/it]
Epoch: 100%|██████████| 2/2 [14:43<00:00, 441.81s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1469/1469 [03:24<00:00,  7.20it/s]

Checking triplets hardness...
100%|██████████| 62660/62660 [00:00<00:00, 134130.32it/s]

Filtering dataset...

##############################
Dataset length:       25000
Hard negatives count: 1834
Easy positives count: 35826
############################## 

Training...
Iteration: 100%|██████████| 391/391 [06:53<00:00,  1.06s/it]
Iteration: 100%|██████████| 391/391 [06:48<00:00,  1.04s/it]
Epoch: 100%|██████████| 2/2 [13:41<00:00, 410.70s/it]

Training classifier
Batches: 100%|██████████| 490/490 [00:17<00:00, 28.06it/s]

Testing
Batches: 100%|██████████| 54/54 [00:01<00:00, 32.89it/s]


###############
# ETA:  2e+04 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.36it/s]

Creating triplets...
100%|██████████| 15585/15585 [01:06<00:00, 234.91it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1462/1462 [04:44<00:00,  5.14it/s]

Checking triplets hardness...
100%|██████████| 62340/62340 [00:00<00:00, 146368.22it/s]

Filtering dataset...

##############################
Dataset length:       29858
Hard negatives count: 32482
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 467/467 [08:34<00:00,  1.10s/it]
Iteration: 100%|██████████| 467/467 [08:34<00:00,  1.10s/it]
Epoch: 100%|██████████| 2/2 [17:08<00:00, 514.24s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1462/1462 [04:44<00:00,  5.14it/s]

Checking triplets hardness...
100%|██████████| 62340/62340 [00:00<00:00, 132290.14it/s]

Filtering dataset...

##############################
Dataset length:       56236
Hard negatives count: 6104
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 879/879 [15:51<00:00,  1.08s/it]
Iteration: 100%|██████████| 879/879 [15:44<00:00,  1.07s/it]
Epoch: 100%|██████████| 2/2 [31:35<00:00, 947.80s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1462/1462 [04:42<00:00,  5.17it/s]

Checking triplets hardness...
100%|██████████| 62340/62340 [00:00<00:00, 133300.29it/s]

Filtering dataset...

##############################
Dataset length:       26840
Hard negatives count: 766
Easy positives count: 34734
############################## 

Training...
Iteration: 100%|██████████| 420/420 [07:28<00:00,  1.07s/it]
Iteration: 100%|██████████| 420/420 [07:25<00:00,  1.06s/it]
Epoch: 100%|██████████| 2/2 [14:53<00:00, 446.77s/it]

Training classifier
Batches: 100%|██████████| 488/488 [00:22<00:00, 21.22it/s]

Testing
Batches: 100%|██████████| 51/51 [00:02<00:00, 23.95it/s]


###############
# ETA:  2e+04 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.09it/s]

Creating triplets...
100%|██████████| 15505/15505 [01:06<00:00, 232.37it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1454/1454 [05:41<00:00,  4.26it/s]

Checking triplets hardness...
100%|██████████| 62020/62020 [00:00<00:00, 149068.72it/s]

Filtering dataset...

##############################
Dataset length:       30102
Hard negatives count: 31918
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 471/471 [08:46<00:00,  1.12s/it]
Iteration: 100%|██████████| 471/471 [08:43<00:00,  1.11s/it]
Epoch: 100%|██████████| 2/2 [17:29<00:00, 524.83s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1454/1454 [05:40<00:00,  4.26it/s]

Checking triplets hardness...
100%|██████████| 62020/62020 [00:00<00:00, 134169.82it/s]

Filtering dataset...

##############################
Dataset length:       24574
Hard negatives count: 2216
Easy positives count: 35230
############################## 

Training...
Iteration: 100%|██████████| 384/384 [07:00<00:00,  1.09s/it]
Iteration: 100%|██████████| 384/384 [06:57<00:00,  1.09s/it]
Epoch: 100%|██████████| 2/2 [13:57<00:00, 418.67s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1454/1454 [05:40<00:00,  4.26it/s]

Checking triplets hardness...
100%|██████████| 62020/62020 [00:00<00:00, 131360.72it/s]

Filtering dataset...

##############################
Dataset length:       42008
Hard negatives count: 292
Easy positives count: 19720
############################## 

Training...
Iteration: 100%|██████████| 657/657 [12:07<00:00,  1.11s/it]
Iteration: 100%|██████████| 657/657 [11:55<00:00,  1.09s/it]
Epoch: 100%|██████████| 2/2 [24:02<00:00, 721.32s/it]

Training classifier
Batches: 100%|██████████| 485/485 [00:26<00:00, 17.98it/s]

Testing
Batches: 100%|██████████| 49/49 [00:02<00:00, 18.66it/s]


###############
# ETA:  2e+04 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.05it/s]

Creating triplets...
100%|██████████| 15425/15425 [01:05<00:00, 236.21it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1447/1447 [05:55<00:00,  4.07it/s]

Checking triplets hardness...
100%|██████████| 61700/61700 [00:00<00:00, 144518.18it/s]

Filtering dataset...

##############################
Dataset length:       28014
Hard negatives count: 33686
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 438/438 [08:09<00:00,  1.12s/it]
Iteration: 100%|██████████| 438/438 [08:06<00:00,  1.11s/it]
Epoch: 100%|██████████| 2/2 [16:16<00:00, 488.15s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1447/1447 [05:49<00:00,  4.14it/s]

Checking triplets hardness...
100%|██████████| 61700/61700 [00:00<00:00, 127970.29it/s]

Filtering dataset...

##############################
Dataset length:       61106
Hard negatives count: 594
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 955/955 [17:30<00:00,  1.10s/it]
Iteration: 100%|██████████| 955/955 [17:10<00:00,  1.08s/it]
Epoch: 100%|██████████| 2/2 [34:41<00:00, 1040.78s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1447/1447 [05:47<00:00,  4.16it/s]

Checking triplets hardness...
100%|██████████| 61700/61700 [00:00<00:00, 130079.93it/s]

Filtering dataset...

##############################
Dataset length:       23226
Hard negatives count: 2244
Easy positives count: 36230
############################## 

Training...
Iteration: 100%|██████████| 363/363 [06:31<00:00,  1.08s/it]
Iteration: 100%|██████████| 363/363 [06:24<00:00,  1.06s/it]
Epoch: 100%|██████████| 2/2 [12:55<00:00, 387.75s/it]

Training classifier
Batches: 100%|██████████| 483/483 [00:28<00:00, 17.04it/s]

Testing
Batches: 100%|██████████| 46/46 [00:02<00:00, 17.55it/s]


###############
# ETA:  1e+04 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.80it/s]

Creating triplets...
100%|██████████| 15345/15345 [01:03<00:00, 240.34it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1439/1439 [05:59<00:00,  4.00it/s]

Checking triplets hardness...
100%|██████████| 61380/61380 [00:00<00:00, 146011.37it/s]

Filtering dataset...

##############################
Dataset length:       30076
Hard negatives count: 31304
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 470/470 [08:49<00:00,  1.13s/it]
Iteration: 100%|██████████| 470/470 [08:49<00:00,  1.13s/it]
Epoch: 100%|██████████| 2/2 [17:39<00:00, 529.53s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1439/1439 [05:59<00:00,  4.00it/s]

Checking triplets hardness...
100%|██████████| 61380/61380 [00:00<00:00, 111146.63it/s]

Filtering dataset...

##############################
Dataset length:       60596
Hard negatives count: 784
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 947/947 [17:25<00:00,  1.10s/it]
Iteration: 100%|██████████| 947/947 [17:10<00:00,  1.09s/it]
Epoch: 100%|██████████| 2/2 [34:36<00:00, 1038.03s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1439/1439 [05:57<00:00,  4.03it/s]

Checking triplets hardness...
100%|██████████| 61380/61380 [00:00<00:00, 136296.65it/s]

Filtering dataset...

##############################
Dataset length:       22410
Hard negatives count: 5226
Easy positives count: 33744
############################## 

Training...
Iteration: 100%|██████████| 351/351 [06:17<00:00,  1.08s/it]
Iteration: 100%|██████████| 351/351 [06:11<00:00,  1.06s/it]
Epoch: 100%|██████████| 2/2 [12:28<00:00, 374.26s/it]

Training classifier
Batches: 100%|██████████| 480/480 [00:28<00:00, 16.62it/s]

Testing
Batches: 100%|██████████| 44/44 [00:02<00:00, 16.74it/s]


###############
# ETA:  1e+04 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.80it/s]

Creating triplets...
100%|██████████| 15265/15265 [01:03<00:00, 241.23it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1432/1432 [05:58<00:00,  4.00it/s]

Checking triplets hardness...
100%|██████████| 61060/61060 [00:00<00:00, 150157.28it/s]

Filtering dataset...

##############################
Dataset length:       27894
Hard negatives count: 33166
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 436/436 [08:10<00:00,  1.12s/it]
Iteration: 100%|██████████| 436/436 [08:09<00:00,  1.12s/it]
Epoch: 100%|██████████| 2/2 [16:19<00:00, 489.94s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1432/1432 [05:56<00:00,  4.01it/s]

Checking triplets hardness...
100%|██████████| 61060/61060 [00:00<00:00, 133203.96it/s]

Filtering dataset...

##############################
Dataset length:       60570
Hard negatives count: 490
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 947/947 [17:26<00:00,  1.11s/it]
Iteration: 100%|██████████| 947/947 [17:09<00:00,  1.09s/it]
Epoch: 100%|██████████| 2/2 [34:35<00:00, 1037.92s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1432/1432 [05:55<00:00,  4.03it/s]

Checking triplets hardness...
100%|██████████| 61060/61060 [00:00<00:00, 133094.24it/s]

Filtering dataset...

##############################
Dataset length:       24948
Hard negatives count: 6734
Easy positives count: 29378
############################## 

Training...
Iteration: 100%|██████████| 390/390 [06:55<00:00,  1.06s/it]
Iteration: 100%|██████████| 390/390 [06:52<00:00,  1.06s/it]
Epoch: 100%|██████████| 2/2 [13:47<00:00, 413.91s/it]

Training classifier
Batches: 100%|██████████| 478/478 [00:29<00:00, 16.36it/s]

Testing
Batches: 100%|██████████| 41/41 [00:02<00:00, 16.14it/s]


###############
# ETA:  8e+03 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.86it/s]

Creating triplets...
100%|██████████| 15185/15185 [01:03<00:00, 237.38it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1424/1424 [06:00<00:00,  3.95it/s]

Checking triplets hardness...
100%|██████████| 60740/60740 [00:00<00:00, 114805.09it/s]

Filtering dataset...

##############################
Dataset length:       29164
Hard negatives count: 31576
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 456/456 [08:36<00:00,  1.13s/it]
Iteration: 100%|██████████| 456/456 [08:32<00:00,  1.12s/it]
Epoch: 100%|██████████| 2/2 [17:08<00:00, 514.34s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1424/1424 [05:59<00:00,  3.96it/s]

Checking triplets hardness...
100%|██████████| 60740/60740 [00:00<00:00, 129400.70it/s]

Filtering dataset...

##############################
Dataset length:       58000
Hard negatives count: 2740
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 907/907 [16:44<00:00,  1.11s/it]
Iteration: 100%|██████████| 907/907 [16:28<00:00,  1.09s/it]
Epoch: 100%|██████████| 2/2 [33:12<00:00, 996.11s/it] 

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1424/1424 [05:55<00:00,  4.01it/s]

Checking triplets hardness...
100%|██████████| 60740/60740 [00:00<00:00, 132372.24it/s]

Filtering dataset...

##############################
Dataset length:       30586
Hard negatives count: 4160
Easy positives count: 25994
############################## 

Training...
Iteration: 100%|██████████| 478/478 [08:52<00:00,  1.11s/it]
Iteration: 100%|██████████| 478/478 [08:37<00:00,  1.08s/it]
Epoch: 100%|██████████| 2/2 [17:29<00:00, 524.99s/it]

Training classifier
Batches: 100%|██████████| 475/475 [00:29<00:00, 15.93it/s]

Testing
Batches: 100%|██████████| 39/39 [00:02<00:00, 16.34it/s]


###############
# ETA:  4e+03 #
###############

Loading encoded lines...
100%|██████████| 8/8 [00:00<00:00, 14.77it/s]

Creating triplets...
100%|██████████| 15105/15105 [01:02<00:00, 242.18it/s]

Training embedder

####################################################################################################

step 1/3

Creating all updated embeddings...
Batches: 100%|██████████| 1417/1417 [05:59<00:00,  3.94it/s]

Checking triplets hardness...
100%|██████████| 60420/60420 [00:00<00:00, 153347.82it/s]

Filtering dataset...

##############################
Dataset length:       27434
Hard negatives count: 32986
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 429/429 [08:05<00:00,  1.13s/it]
Iteration: 100%|██████████| 429/429 [08:03<00:00,  1.13s/it]
Epoch: 100%|██████████| 2/2 [16:09<00:00, 484.73s/it]

####################################################################################################

step 2/3

Creating all updated embeddings...
Batches: 100%|██████████| 1417/1417 [06:00<00:00,  3.93it/s]

Checking triplets hardness...
100%|██████████| 60420/60420 [00:00<00:00, 129524.09it/s]

Filtering dataset...

##############################
Dataset length:       59296
Hard negatives count: 1124
Easy positives count: 0
############################## 

Training...
Iteration: 100%|██████████| 927/927 [17:12<00:00,  1.11s/it]
Iteration: 100%|██████████| 927/927 [16:51<00:00,  1.09s/it]
Epoch: 100%|██████████| 2/2 [34:04<00:00, 1022.32s/it]

####################################################################################################

step 3/3

Creating all updated embeddings...
Batches: 100%|██████████| 1417/1417 [05:56<00:00,  3.97it/s]

Checking triplets hardness...
100%|██████████| 60420/60420 [00:00<00:00, 127787.04it/s]

Filtering dataset...

##############################
Dataset length:       24620
Hard negatives count: 486
Easy positives count: 35314
############################## 

Training...
Iteration: 100%|██████████| 385/385 [06:56<00:00,  1.08s/it]
Iteration: 100%|██████████| 385/385 [06:52<00:00,  1.07s/it]
Epoch: 100%|██████████| 2/2 [13:48<00:00, 414.34s/it]

Training classifier
Batches: 100%|██████████| 473/473 [00:29<00:00, 15.79it/s]

Testing
Batches: 100%|██████████| 36/36 [00:02<00:00, 15.64it/s]


###############
# ETA:  0e+00 #
###############
